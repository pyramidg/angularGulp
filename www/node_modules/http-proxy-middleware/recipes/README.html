<h1>Recipes</h1><p>Common usages of <code>http-proxy-middleware</code>.</p>
<h1>Configuration example</h1><p>Overview of <code>http-proxy-middleware</code> specific options.</p>
<p>http-proxy-middleware uses Nodejitsu&#39;s <a href="https://github.com/nodejitsu/node-http-proxy">http-proxy</a> to do the actual proxying. All of its <a href="https://github.com/nodejitsu/node-http-proxy#options">options</a> are exposed via http-proxy-middleware&#39;s configuration object.</p>
<pre><code class="language-javascript">var proxyMiddleware = require(&quot;http-proxy-middleware&quot;);
var winston = require(&#39;winston&#39;);

/**
 * Context matching: decide which path(s) should be proxied. (wildcards supported)
 **/
var context = &#39;/api&#39;;

/**
 * Proxy options
 */
var options = {
    // hostname to the target server
    target: &#39;http://localhost:3000&#39;,

    // set correct host headers for name-based virtual hosted sites
    changeOrigin: true,

    // enable websocket proxying
    ws: true,

    // additional request headers
    headers: {
        &#39;x-powered-by&#39;: &#39;foobar&#39;
    },

    // rewrite paths
    pathRewrite: {
        &#39;^/old/api&#39;: &#39;/new/api&#39;,    // rewrite path
        &#39;^/remove/api&#39;: &#39;&#39;          // remove path
    },

    // re-target based on the request&#39;s host header and/or path
    proxyTable: {
      // &lt;request&gt;                   :  &lt;new target&gt;
        &#39;integration.localhost:8000&#39; : &#39;http://localhost:8001&#39;,  // host only
        &#39;staging.localhost:8000&#39;     : &#39;http://localhost:8002&#39;,  // host only
        &#39;localhost:8000/api&#39;         : &#39;http://localhost:8003&#39;,  // host + path
        &#39;/rest&#39;                      : &#39;http://localhost:8004&#39;   // path only
    },

    // control logging
    logLevel: &#39;silent&#39;,

    // use a different lib for logging;
    // i.e., write logs to file or server
    logProvider: function (provider) {
        return winston;
    },

    // subscribe to http-proxy&#39;s error event
    onError: function onError(err, req, res) {
        res.writeHead(500, {&#39;Content-Type&#39;: &#39;text/plain&#39;});
        res.end(&#39;Something went wrong.&#39;);
    },

    // subscribe to http-proxy&#39;s proxyRes event
    onProxyRes: function (proxyRes, req, res) {
        proxyRes.headers[&#39;x-added&#39;] = &#39;foobar&#39;;
        delete proxyRes.headers[&#39;x-removed&#39;];
    },

    // subscribe to http-proxy&#39;s proxyReq event
    onProxyReq: function (proxyReq, req, res) {
        // add custom header to request
        proxyReq.setHeader(&#39;x-powered-by&#39;, &#39;foobar&#39;);
    }

    /**
     * The following options are provided by Nodejitsu&#39;s http-proxy
     */

    // target
    // forward
    // agent
    // ssl
    // ws
    // xfwd
    // secure
    // toProxy
    // prependPath
    // ignorePath
    // localAddress
    // changeOrigin
    // auth
    // hostRewrite
    // autoRewrite
    // protocolRewrite
    // headers


};

/**
 * Create the proxy middleware, so it can be used in a server.
 */
var proxy = proxyMiddleware(context, options);
</code></pre>
